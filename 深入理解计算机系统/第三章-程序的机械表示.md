# 第三章

## 3.4 访问信息

一个x86-64的中央处理单元包含一组16个存储64位值的通用目的寄存器。这些寄存器用来存储整数数据和指针。以下为常用寄存器

64 |32|16|8|funtion
-|-|-|-|-|
%rax| %eax|%ax|%al|返回值
%rbx| %ebx|%bx|%bl|被调用这保存
%rcx| %ecx|%cx|%cl|第四个参数
%rdx| %edx|%ax|%dl|第三个参数
%rsi| %esi|%ax|%si|第二个参数
%rdi| %edi|%di|%dil|第一个参数
%rbp| %ebp|%bp|%bpl|被调用者保存
%rsp| %esp|%sp|%spl|栈指针
%r8| %r8d|%r8w|%r8b|第五个参数
%r9| %r9d|%r9w|%r9b|第六个参数
%r10| %r10|%r10w|%r10b|调用者保存
%r11| %r11|%r11w|%r11b|调用者保存
%r12| %r12|%r12w|%r12b|调用者保存
%r13| %r13|%r13w|%r13b|调用者保存
%r14| %r14|%r14w|%r14b|调用者保存
%r15| %r15|%r15w|%r15b|调用者保存

### 3.4.1 操作数指示符

大多数指令有一个或多个操作数(operand),指示出执行一个操作中要使用的源数据值，以及放置结果的目的位置。x86-64支持多种操作格式。元数据可以以常数形式给出，或者从寄存器或内存中读出。结果可以放在寄存器或内存中。因此，各种不同操作数可以分成三种类型:

1. 立即数(immediate):用来表示常数值，在ATT格式的汇编代码中，立即数的书写方式是'$'后面跟一个用标准C表示法表示的整数, 比如, $-577或 $0x1F。
2. 寄存器(register),它表示某个寄存器的内容。我们用R[寄存器名称]代表其值
3. 内存引用，她会根据计算出来的地址（通常称为有效地址)访问某个内存位置。

寻址的模式
|类型|格式|操作数值|名称|
|--|--|-|-|
|立即数|$Imm|Imm|立即数寻址|
|寄存器|r_a|R[r_a]|寄存器寻址
|存储器|Imm|M[Imm]|绝对寻址|
|存储器|(r_a)|M[R[r_a]]|间接寻址|
|存储器|Imm(r_b)|M[Imm+R[r_a]]|(基址+偏移量)寻址|
|存储器|（r_b,r_i)|M[R[r_b]+R[r_i]]|变址寻址|
|存储器|（Imm(r_b,r_i)|M[Imm+R[r_b]+R[r_i]]|变址寻址|
|存储器|（r_i,s)|M[R[r_i]*s]|比例变址寻址|
|存储器|Imm（r_i,s)|M[Imm+R[r_i]*s]|比例变址寻址|
|存储器|（r_b,r_i,s)|M[R[r_b]+R[r_i]*s]|比例变址寻址|
|存储器|Imm（r_b,r_i,s)|M[Imm+R[r_b]+R[r_i]*s]|比例变址寻址|

例如: %rax, 0x104, $0x104, (%rax), 4(%rax), 9(%rax,%rdx), 260(%rcx,%rdx)

0xFC(,%rcx,4),(%rax,%rdx,4)

### 3.4.2 数据传递指令
最频繁使用的指令是将数据从一个位置复制到另一个位置的指令。操作数表示的通用性使得一条简单的数据传送指令能够完成在许多机器中要好几条不同指令才能完成的功能。

MOV类有四类指令组成，movb, movw,movl 和movq, 分别是1,2,3,8字节

MOV S,D 效果 D<-S,源操作数的值一定是一个立即数，存储在寄存器中或者内容中。目的操作数指定一个位置，要么是一个寄存器或者，要么是一个内存地址，传送指令两个操作数不能指向内存位置。将一个值从一个内存位置复制到另一个内存位置需要两条指令-第一条指令将源值加载到寄存器中，第二条指令将改寄存器的值写入到目的位置。